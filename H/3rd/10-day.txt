3주차 라우터, 스위치 넷 째 날

루프가 발생하는 조건

OSPF 네트워크 경로를 가장 최적의 경로로 계산한다.
모든 다이나믹 프로토콜은 자신만의 계산 알고리즘이 있다.
RIP 같은 경우에는 단순하게 홉만 본다 / A    ->    B 출발지 A에서 목적지 B까지 가장 가까운 경로 (홉의 개수 HOP COUNT)
단순하게 HOP만 본다.

Distance Vector :

주기적으로 Neighbor Router간 라우팅 업데이트를 실시한다.    * 자주 볼 용어이다.

RIP : (루프가 발생한다)
icmp type 11 : 타임 초과 // 전송 중에 TTL 값이 더 이상 없습니다. 라는 초과 메시지
Distance vector :  RIP, IGRP , EIGRP (Hybird 지만 루핑이 발생한다. Distance vector에 가깝다)
네트워크 전체에서 받은 정보만 가지고, 테이블을 반영한다.    /    나 혼자만 이렇게 있을 거 라고 상상을 한다.
기본적으로 자기가 가지고 있는 라우팅 테이블을 주기적으로 업데이트한다.

-RIP Timer
.Update Time : 30초
.Invalid Time : 180초 (업데이트를 해주고 다른 라우터가 정보를 주는 동안  업데이트 할 수 있는 시간)
.Holddown Time : 180초 (포이즈닝 상태일 때)
.Flushed Time : 240초 (비우는 시간 240초 / 다 되더라도 정보가 오더라도 받지 않는다)

-Update      |---30초---|
-Invalie        |----------- 180초 -----------|
-Holddown                                         |----------- 180초 -----------|
-Flushed        |-------------------240초-------------------|

-Metric
.Router는 하나의 목적지에 대해서 하나의 경로만을 지원하는 장비이다.
.하나의 목적지에 대해서 복수개의 경로가 존재할경우 Metric이 가장 작은 경로를 사용하여 통신이 실시된다
.RIP은 Hop-count를 사용하여 최적경로를 선출한다. [0~15]
.RIP은 Metric *16에 대해서 장애발생으로 인식된다.

-업데이트 : *UDP 520번 , Broadcast [255.255.255.255]

RIPv2

-업데이트 방식 : UDP 520번을 사용하며 , * Multicast [224.0.0.9]

Link State :
전체의 정보를 다 수집해서 라우터가 다 이해 하고 있다.
모든 경로를 라우터가 다 알고 최적의 경로를 계산해서 루프가 발생할 상황을 만들지 않는다.

-Link-State알고리즘
.인접성이 맺어진 라우터 상호간 라우팅업데이트를 실시
.Link변화시 변화된 부분에 대해서 *부분적인 업데이트를 실시
.변경사항이 없으면 업데이트를 실시하지 않는다. (타이머가 없다)

OSPF의 주요 Metric을 계산하는 방법은 bandwidth (대역폭)을 계산해서 수치화한다.
RIP의 Metric 값이 다르다 (RIP은 HOP)

baseband : 
어떤 하나의 매체 (미디어) / 인터넷 하나의 대역대에 하나의 데이터만 보낼 수 있다.
데이터를 통신 할 수 있는 통로, 무선네트워크
매체에 특정 데이터를 하나만 흘려 보낼 수 있느냐, 데이터를 여러 개 동시에 흘려 보낼 수 있느냐
UTP : baseband 하나의 데이터만을 흘려 보낸다.    /    우리가 사용하는 컴퓨터, 인터넷 등은 베이스 밴드이다.

broadband :
안테나가 있으면 공중파 신호를 받을 수 있다. (KBS,SBS,MBC,EBC)    /    전파로 방송을 송충한다.
하나의 전파 안에 여러 개의 신호를 보낸다.    /    TV 채널 개념 / 어떤 특정 주파수위 범위에서 일부분을 맞춰서 그 신호만 받는다.
TV 동축 케이블 (coaxial cable) ->브로드밴드 통신
브로드밴드 통신 할 수 있다. 수많은 신호를 흘려 일정 데이터를 볼 수 있다.

SK broadband = 인터넷, TV 등 다양한 컨텐츠를 처리한다 라는 의미로 broadband 이다.

Bandwidth 대역폭 /
같은 속도의 폭이 많아지면 한꺼번에 많은 데이터를 처리한다.
스피드의 총 합을 bandwidth 라고 한다.
와이파이를 예로 같은 스피드라고 하더라도 많은 데이터를 처리한다.

speed

speed와 bandwidth은 같으면서도 다른 개념이다.
구분 할 필요는 없지만 개념은 다르다.

Link Aggregation ( 사전적 의미 : 통합 )
네트워크 카드 2개를 하나로 묶을 수 있다.
2개의 포트를 하나인 것 처럼 논리적으로 만든다.

회사마다 이름이 다른데, Cisco는 Ether channel | Bongding (붙이다 라는 의미) | Teamming 등으로 불린다.

LTE-A : 
LTE 에서 발전한 형태, 서로 떨어져 있는 채널을 하나의 채널인 것 처럼 만들어준다.
Link Aggregation의 개념이다. 서로 다른 대역을 하나로 만들어준다.
연속적인 하나의 채널을 받는게 좋다.

FM 라디오, 몇 십 MHZ ~ 몇 백 MHZ
와이파이는 2.4 ~ 2.5 G

TTL 값
리눅스는 63부터 출발한다    /    윈도우는 128부터 출발한다.    /    유닉스는 256부터 출발한다.

TTL이 부족해서 못 가는 경우는 없다.

Hold down Timer
모든 라우터는 hlod down timer를 가지고 있다.
특정 네트워크 정보를 받고 timer 기간동안 해당 네트워크에 정보가 들어와도 갱신하지 않는다.

Route Posonig / Poison Rervers
최대 카운트가 Hop 카운터는 15개 인데, 라우터가 다운이나 고장이 나면 16으로 전달을해서 Down이라 기록하지 않고, 16 업데이트 주기가 되면 독 걸린 정보를 모든 라우터에 전파한다.

Split horizon
라우팅 정보가 들어온 곳으로 같은 정보를 내보낼 수 없다는 것이다.
두 라우팅 간의 루핑만을 막기 위해서 만들어진 기술이고, 전체 라우팅 네트워크의 루핑을 막는 것은 힘들다.

Triggered Update
루프를 방지하는 기법 중 하나 이지만, 다른 기법과 다르게 직접 설정으로 구성을 해야하고, Down이 되면 즉시 전달하지만 할 일이 많아져서 매번 체크 해야되고 그로 인해 리소스 소모가 커서 전체 속도저하가 될 수 있다. (차라리 OSPF 구성이 나을 거 같다) / (고급 라우터에 사용하면 좋다)

네트워크에서는 루핑이 발생 할 수 있다. (STATIC에서도 루핑 발생이 가능)
TTL이 초과가 발생 OR TTL 모자라거나 통신을 할 때 TTL을 정할 수 있다 (그런 경우는 거의 없다)    /    네트워크 루프 발생 조건이다.

IP HEADER 1만 세팅
첫 번째 라우터 = GATEWAY
두 번째 TTL 2로 세팅 -> 2번째 라우터가 응답하고,
TTL을 하나씩 증가하다보면 목적지까지 간다.

* :
모든 라우터가 ICMP ERROR REPORT를 작성하는 것은 아니다. (종료가 가능하다)
오류 응답을 안해주는 것    /    ICMP는 보조적인 역할을 하는 프로토콜
네트워크 데이터 통신을 할 때 쓸모가 없다    /    통신이 가능한지 판별을 한다.
ICMP가 응답을 해주지 않아도 통신하는데는 지장이 없다.
기업에서 최근에 해킹 등 보안 상의 이슈 때문에 ICMP 응답을 안해주는 경우가 많다.
보안 장바는 ICMP REPORTING을 기본적으로 하지 않는다. OR 어느정도 위치에서 패킷을 막는 방법을 사용한다.

Adminstrative Distance

static = 1
ospf = 110
rip = 120

https://en.wikipedia.org/wiki/Administrative_distance (참고)

TCP state

Access contol list : 접근제어를 할 수 있는 목록
네트워크에서 ACL은 무슨 의미냐 = 방화벽 (FIREWELL)
Packet Filter : 패킷을 필터링 한다.
IP    /    PORT    /    PROTOCOL
POLICY    /    RULE    :    정책 / 어디를 차단할건지 말건지. (포트, 프로토콜, IP)

방화벽에도 세대가 있다. 1세대 2세대 3세대 (Generation)
시스코에도 방화벽 제품이 있는데, 라우터가 아니라 방화벽 제품으로 나왔고, 라우터에 방화벽 기능을 한다. 가장 기본적은 것만 제공한다.

시중에서 판매하는 방화벽 :
APPLICATION 방화벽,    상태 방화벽    (기능이라던지 세대가 훨씬 높다)

정책을 만들고 어떤 인터페이스에 적용할 것 인지.
<ACL number> 번호를 지정 할 수 있다. (하나의 번호 안에는 여러 개의 정책이 있을 수 있다)
{permit | deny} / { A    :    B } >- 선택지 둘 중에 하나를 선택 해야한다.
< > : 어떤 값을 입력을 해야한다.
[  ] : 선택지, 해도 되고 안해도 된다    /    설정을 할껀데 필요하면 해야되고, 안해도 관계 없다. (옵션)
(  ) : 위와 같다. 선택을 해도되고, 안해도 된다

메뉴얼을 사용 할 때 위의 괄호를 보고 참조하면 좋다.

모든 보안 장비는 작은 범위부터 큰 범위 순서로 설정해야한다.
큰 범위를 먼저 설정하고 작은 범위를 설정하면, 작은 범위에 설정한 정책들이 큰 범위의 정책에 의해 적용이 안된다.
마지막엔 항상 deny any가 존재한다.
허용을 할 것을 적어놓고 나머지를 막아놓는다.

ex)
access-list 2 deny 192.168.0.3 0.0.0.0

acccess-list 2 permit any
acceess-list 2 deny any - x

일부만 막는다는 커맨드.
큰 범위의 정책에 막힌다.

2. Extended ACL
access-list <100~199> {permit|deny} <Proto> <SRC Addr> <WM> [
OP] [SRC Port] <DST Addr> <WM> [OP] [DST Port]

.Protocol: tcp, udp, icmp, ip ...
.OP(Operation): eq, neq, gt, lt, range

ex)
출발지와 목적지가 있기 때문에 access-list 100 permit ip any any