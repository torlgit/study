43day

oVirt 설치과정

엔진(Engine)
가상화 환경을 물리적/논리적 자원을 관리하는 중앙 관리 플랫폼

Engine
1. 운영체제 설치
2. 레포지토리 파일 등록
3. yum 업데이트, 패키지 설치 (ovirt-engine)
4. engine-setup
5. dns 설정 (dns가 없다면 hosts)

Hosted (일반 centos 설치)
1. 운영체제 설치
2. 레퍼지토리 파일 등록 (vdsm)
3. 패키지 설치
4. dns 설정 (dns가 없다면 hosts)

baremetal (ovirt homepage h.v 설치)
1. 하이퍼바이저 설치
2. dns 설정 (dns가 없다면 hosts)

어제 배운 내용 정리

가상화 정리
자원을 효율적으로 쓰기 위해서 사용을 한다.
하나의 시스템으로 여러 개의 시스템을 돌리기 위해서 사용
가상화 기술에서 가장 중요한게 독립성을 유지해줘야한다.

서버 가상화
실제 내가 관리할 때 하나의 엔진 머신에서 서비스를 설정해두고 웹 콘솔등을 이용해서 관리한다.
매니저머신에 연결 되어있는 물리적인 호스트 시스템들을 직접 서버에서 하나의 중앙집중화된 관리를 할 수 있다.
호스트 위에 vm 등 가상화 프로세스를 실행할 수 있다.

호스트 - 물리적인 실제 하드웨어 시스템 (메모리, 디스크, cpu 등) 제공
게스트 - 가상머신
하이퍼바이저 - 호스트 시스템에서 게스트 가상머신을 관리하는게 하이퍼바이저이다.

전가상화, 반가상화
전가상화를 대중적으로 많이 사용한다. 성능은 반가상화가 좋지만 커널을 수정할 수 있는 리눅스, 유닉스는 사용이 가능하지만 윈도우는 사용이 불가능하고 수정이 어렵기 때문에 전가상화를 선호한다.
지금의 전가상화는 반가상화와 성능차이도 옛날만큼 많이 나지 않는다.

일반 시스템
app -> os -> hw

가상 시스템
app -> os -> h.v -> os -> hw

가로채는걸 트랩, 바꾸는 걸 에뮬레이터라고 한다.
하이퍼바이저는 독립성 유지가 중요하다. (모니터링, 주변장치 기능도 있다)

하이퍼바이저 종류
native - bvaremetal, 운영체제 없이 처음부터 h.v 를 직접 설치하는 방식 (최소한의 운영체제 역할만을 담당)
hosted - native의 반대되는 역할, 평소에 쓰고 있는 시스템처럼 os 위에서 설치파일을 이용해 h.v를 설치하는 방식

가상화, 클라우드
사용용도, 빈ㅁ도로 구분해서 적합한 방법을 찾아서 적용한다.

ovirt = 서버 가상화를 관리하는 도구, 패키지
kvm = 리눅스 환경에서 가장 기본이 되는 가상화 방식 (도구)

host 관리를 하기 위해 vdsm가 필요하다.

ovirt 4.3 / centos 6,7

클러스트 : 그룹
마이그레이션 : 옮겨지는 것(가상 머신을 다른 장치로 옮겨 가는 것) / 물리적인 장치가 고장나도 자동으로 옮겨지거나, 수동으로 옮기는것 (자동, 수동 다 가능하다)

engine-iso-uplodaer -i iso 경로. [iso를 업로드 하는 명령어]

ovirt 기본 설치, 요구 사항.
정방향  및 역방향 dns 구성  (hosts 파일 대체가능)
fqdn, 방화벽 구성 등

호스트
cockpit 기반의 웹 인터페이스, 개별 호스트를 원격으로 관리 및 검사 가능 ( ssh를 통한 직접관리는 안된다 )

스토리지 도메인

데이터 도메인 (필수, 우선적)
디스크 이미지, 가상 컴퓨터용 스토리지 저장을 말한다.
모든 데이터 센터에는 하나 이상의 데이터 도메인이 필수
한번에 하나의 데이터 센터만 연결 가능

ISO 도메인
설치용 이미지(ISO파일) 저장
데이터 센터에 하나 또는 그 이상 ISO 도메인이 연결되어 있어야한다.
데이터 센터에 공유 가능

export 스토리지
이전 버전에서는 사용을 했었는데, 지금은 사용을 안하는 형태이다.

스토리지 설정은 nfs, iscsi 등으로 내보낸다.
read-write 권한이 필요 [사용자 uid36 (vdsm) gid 36 (kvm) 디렉토리 권한 및 소유권이 필요]
하나 이상의 호스트가 존재하는 활성화된 SPM 설정이 필요하다.

engine-iso-uploader 명령어를 사용해 이미지를 업로드 할 수 있다.
수동으로 nfs 내보내기, 복사 가능 (업로드 시 권한 640 필요 / 소유권, 소유자 필요)

가상머신 생성
spice 또는 vnc 프로토콜 사용 (우리는 spice로 했다)
브라우저 기반 콘솔 클라이언트이다.

가상머신 생성, 가상서버 설치
가상컴퓨터가 사용할 디스크 이미지와 네트워크 설정을 해서 생성

가성머신 pxe 부팅이다. kickstart 설치 가능
ISO 도메인 사용, 특정 이미지를 이용해 수동 설치